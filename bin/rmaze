#!/usr/bin/env ruby

require './lib/rmaze.rb'
require 'optparse'

options = {
	:width => 10,
	:height => 10,
	:algorithm => :backtrace
}
OptionParser.new do |opts|
	opts.banner = "Usage: rmaze [options]"

	opts.separator ""
	opts.separator "Basic options:"
	opts.on("-w", "--width width", "Specify the maze width (default: #{options[:width]})") do |width|
		options[:width] = width
	end
	opts.on("-h", "--height height", "Specify the maze height (default: #{options[:height]})") do |height|
		options[:height] = height
	end

	opts.separator ""
	opts.separator "Algorithms:"
	opts.on("-b", "--backtrace", "Choose backtrace algorithm (default)") do |bt|
		options[:algorithm] = bt ? :backtrace : nil
	end
end.parse!

maze = Maze.new options[:width], options[:height]
maze.set_raw_value_all 1

case options[:algorithm]
when :backtrace
	backtrace = Backtrace.new maze
    backtrace.generate
else
	$stderr.puts "Error: the algorithm must be set."
	exit(-1)
end

maze.matrix.each_with_index do |row, index|
    puts row.map(&:to_s).join(' ').gsub('0', ' ').gsub('1', '#')
end
